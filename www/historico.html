<!DOCTYPE html>
  <html>
    <head>
      <!--Import Google Icon Font-->
      <link href="css/icon.css" rel="stylesheet">
	   <link href="css/style.css" rel="stylesheet">
      <!--Import materialize.css-->
      <link type="text/css" rel="stylesheet" href="css/materialize.css"  media="screen,projection"/>	    
	  <link rel="stylesheet" type="text/css" href="css/flaticon.css">

      <!--Let browser know website is optimized for mobile-->
		<meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, target-densitydpi=medium-dpi, user-scalable=0" />
	    <meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'"/>
		
        <title>Centralina</title>
      
    
    </head>
<body>


<div class="navbar-fixed">
    <nav>
     <div class="nav-wrapper light-blue darken-1">
        <a href="#!" class="brand-logo">Centralina</a>
		<ul class="right">
			<li><a href="alarme.html"  class="brand-logo flaticon-police22  small_icon right"></a>	</li>			
		</ul>
		<ul id="slide-out" class="side-nav">
		
		<li class="active light-blue darken-1 center">

			<h5 class="name_nav white-text center" id="profile">Profile</h5>
			
		</li>
		
		<li>
			<a href="index.html" >			
				<div class="menu_icon flaticon-power43"></div>
				<span class="name_nav">Atuadores</span>
			</a>
		</li>
		
		<li class="active gray lighten-2 ">
			<a href="alarme.html">
				<div class="menu_icon flaticon-police22"></div>
				<span class="name_nav">Alarme</span>
			</a>
		</li>
		
		<li>
			<a href="config.html">
				<div class="menu_icon flaticon-settings48"></div>
				<span class="name_nav">Configurações</span>
			</a>
		</li>

		<li>		
			<a  href="sensor.html">
				<div class="menu_icon flaticon-temperature10"></div>
				<span class="name_nav">Sensores</span>
			</a>
		</li>
		
		<li>		
			<a href="agendamento.html">
				<div class="menu_icon flaticon-clock130"></div>
				<span class="name_nav">Agendamento</span>
			</a>
		</li>

</ul>
  <a href="#" data-activates="slide-out" class="button-collapse"><i class="mdi-navigation-menu"></i></a>
   <div class="progress">
      <div id="bar" ></div>
	</div>
      </div>
    </nav>
  </div>	

<div class="section white">
	 <ul class="collection with-header">
        <li class="collection-header"><h5 class="center">Historico do Alarme</h5></li>
        <li class="collection-item"><div id="log0">Carregando...<span class="secondary-content">...</span></div></li>
        <li class="collection-item"><div id="log1">Carregando...<span class="secondary-content">...</span></div></li>
        <li class="collection-item"><div id="log2">Carregando...<span class="secondary-content">...</span></div></li>        
		<li class="collection-item"><div id="log3">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log4">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log5">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log6">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log7">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log8">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log9">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log10">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log11">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log12">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log13">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log14">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log16">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log17">Carregando...<span class="secondary-content">...</span></div></li>
		<li class="collection-item"><div id="log18">Carregando...<span class="secondary-content">...</span></div></li>
      </ul>
	<!--Modal extructure -->
	<div id="modal1" class="modal">
    <div class="modal-content">
      <h5>Atenção</h5>
      <p>Não foi possivel encontrar o endereço da central.</p>
	  <p>Vá em configurações e altere o ip da central ou verifique sua conexão de internet.</p>
    </div>
    <div class="modal-footer">
	  <a href="config.html" class=" modal-action modal-close waves-effect waves-green btn-flat">Configurar</a>
      <a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat" onClick="window.location.reload()">Recarregar</a>
    </div>
	</div>	
</div>


      <script type="text/javascript" src="cordova.js"></script>     
	  <script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
      <script type="text/javascript" src="js/materialize.js"></script>
	  
	  <script type="text/javascript">
//Descomentar quando for compilar

var url = '';
var chave = '';	

// Initialize collapse button
  $(".button-collapse").sideNav();



//Faz requisição no banco de dados referente ao consumo de agua e mostra nos displays do cabeçalho da dasboard
function getHist(){     
	 $("#bar").addClass('indeterminate');
		$.ajax({
				method: "POST",
				dataType: "json",
				url: "http://"+url+"/dash/historico.php",
				timeout: 8000,
				data: { comando: "update"}
				})
			.done(function( requestArray ) {
			$("#log0").html(requestArray.log0+'<span class="secondary-content">'+requestArray.dataLog0+'</span>');
			$("#log1").html(requestArray.log1+'<span class="secondary-content">'+requestArray.dataLog1+'</span>');
			$("#log2").html(requestArray.log2+'<span class="secondary-content">'+requestArray.dataLog2+'</span>');
			$("#log3").html(requestArray.log3+'<span class="secondary-content">'+requestArray.dataLog3+'</span>');			
			$("#log4").html(requestArray.log4+'<span class="secondary-content">'+requestArray.dataLog4+'</span>');
			$("#log5").html(requestArray.log5+'<span class="secondary-content">'+requestArray.dataLog5+'</span>');
			$("#log6").html(requestArray.log6+'<span class="secondary-content">'+requestArray.dataLog6+'</span>');
			$("#log7").html(requestArray.log7+'<span class="secondary-content">'+requestArray.dataLog7+'</span>');
			$("#log8").html(requestArray.log8+'<span class="secondary-content">'+requestArray.dataLog8+'</span>');
			$("#log9").html(requestArray.log9+'<span class="secondary-content">'+requestArray.dataLog9+'</span>');
			$("#log10").html(requestArray.log10+'<span class="secondary-content">'+requestArray.dataLog10+'</span>');
			$("#log11").html(requestArray.log11+'<span class="secondary-content">'+requestArray.dataLog11+'</span>');
			$("#log12").html(requestArray.log12+'<span class="secondary-content">'+requestArray.dataLog12+'</span>');
			$("#log13").html(requestArray.log13+'<span class="secondary-content">'+requestArray.dataLog13+'</span>');
			$("#log14").html(requestArray.log14+'<span class="secondary-content">'+requestArray.dataLog14+'</span>');
			$("#log15").html(requestArray.log15+'<span class="secondary-content">'+requestArray.dataLog15+'</span>');
			$("#log16").html(requestArray.log16+'<span class="secondary-content">'+requestArray.dataLog16+'</span>');
			$("#log17").html(requestArray.log17+'<span class="secondary-content">'+requestArray.dataLog17+'</span>');
			$("#log18").html(requestArray.log18+'<span class="secondary-content">'+requestArray.dataLog18+'</span>');
			$("#bar").removeClass('indeterminate');
			}).fail(function (jqXHR,status,err) {
					$('#modal1').openModal({
						dismissible: false,
			
					});
					
				});
				
} 
document.addEventListener("deviceready", onDeviceReady, false);
			
function onDeviceReady() {
	Materialize.toast("Historico", 1000);
	url = window.localStorage.getItem("ip");
	chave = window.localStorage.getItem("chave");
	$("#profile").text(window.localStorage.getItem("nome"));
	$('#ip').val(url);
	$('#password').val(chave);
	getHist();
		
				
}

 
	</script>
	
	
</body>
</html>